 main.py:

 Vecchi training e validation loops:


    """
    criterion = nn.MSELoss()

    optimizer = optim.Adam(model.parameters(), lr=LR)
    # optimizer = optim.SGD(model.parameters(), lr=LR, momentum=0.9) # va peggio di Adam




    print(f"{ok}Arrivato al loop.\n")
    for epoch in range(EPOCHS):
        model.train()
        train_loss = 0.0

        # TODO: migliorare e fare 2 funzioni:
        #  1° con il loop di training, che ritorna la loss di training
        #  2° con il loop di validazione, che ritorna la loss di validazione

        ###################### LOOP DI TRAINING ######################
        for images, keypoints in train_loader:
            images = images.to(DEVICE)
            keypoints = keypoints.to(DEVICE)

            optimizer.zero_grad()
            outputs = model(images)
            loss = criterion(outputs, keypoints)
            loss.backward()
            optimizer.step()

            train_loss += loss.item() * images.size(0)  # tensore.item() mi fa passare da tensore[ numero ] a numero

        avg_train_loss = train_loss / len(train_loader.dataset)


        ######### LOOP DI VALIDAZIONE #########
        model.eval()
        val_loss = 0.0
        val_mae_total = 0.0
        val_med = 0.0

        with torch.no_grad():
            for images, keypoints in test_loader:
                images = images.to(DEVICE)
                keypoints = keypoints.to(DEVICE)

                outputs = model(images)
                loss = criterion(outputs, keypoints)
                val_loss += loss.item() * images.size(0)

                mae_batch = calcola_mae_pixel(outputs, keypoints, IMG_SIZE)
                val_mae_total += mae_batch * images.size(0)
                val_med += mean_euclidean_distance(outputs, keypoints, IMG_SIZE) * images.size(0)

        avg_val_loss = val_loss / len(test_loader.dataset)
        avg_val_mae = val_mae_total / len(test_loader.dataset)
        avg_val_med = val_med / len(test_loader.dataset)

        print(
            f"Epoch [{epoch + 1}/{EPOCHS}] | Train Loss: {avg_train_loss:.5f} | Val Loss: {avg_val_loss:.5f} | Val MAE: {avg_val_mae:.2f}px | Val MED: {avg_val_med:.2f}px")  # TODO: da aggiungere:

    """